@startuml analysis-sequence
!theme plain
actor Client
participant "添加接口" as AddAPI
participant "行为分析服务" as Mining
participant "摘要生成服务" as Summary
participant "Milvus数据库" as Milvus

Client -> AddAPI: POST /add (video_url, action_type)
activate AddAPI

alt action_type = 1
    AddAPI -> Mining: 调用行为分析
    activate Mining
    Mining --> AddAPI: 返回分析结果
    deactivate Mining
else action_type = 2
    AddAPI -> Summary: 调用摘要生成
    activate Summary
    Summary --> AddAPI: 返回摘要结果
    deactivate Summary
else action_type = 3
    AddAPI -> Mining: 调用行为分析
    activate Mining
    Mining --> AddAPI: 返回分析结果
    deactivate Mining
    
    AddAPI -> Summary: 调用摘要生成
    activate Summary
    Summary --> AddAPI: 返回摘要结果
    deactivate Summary
end

AddAPI -> Milvus: 存储分析结果
activate Milvus
Milvus --> AddAPI: 确认存储完成
deactivate Milvus

AddAPI --> Client: 返回处理结果
deactivate AddAPI

@enduml